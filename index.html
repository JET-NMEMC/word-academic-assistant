<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>学术写作助手</title>
    
    <!-- Office.js -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    
    <!-- Fluent UI Core CSS & Icons -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
    <link rel="stylesheet" href="taskpane.css?v=1.2.0" type="text/css" />
</head>

<body class="ms-Fabric ms-font-m">
    <div id="app-container">
        <!-- 头部导航 -->
        <header class="app-header">
            <div class="app-logo">
                <i class="ms-Icon ms-Icon--ReadingMode" aria-hidden="true"></i>
            </div>
            <div class="app-title">
                <h1 class="ms-font-l">学术写作助手</h1>
                <p class="ms-font-xs">专业汉语润色与学术译英</p>
            </div>
        </header>

        <main class="app-content">
            <!-- 配置折叠面板 -->
            <details class="config-accordion">
                <summary class="ms-font-s">
                    <i class="ms-Icon ms-Icon--Settings" aria-hidden="true"></i>
                    服务配置
                    <i class="ms-Icon ms-Icon--ChevronDown chevron" aria-hidden="true"></i>
                </summary>
                <div class="config-content">
                    <div class="ms-TextField">
                        <label class="ms-Label">API Key</label>
                        <input type="password" id="doubao-api-key" class="ms-TextField-field" placeholder="请输入火山引擎 API Key" />
                    </div>
                    <div class="ms-TextField">
                        <label class="ms-Label">推理接入点 (Endpoint ID)</label>
                        <input type="text" id="endpoint-id" class="ms-TextField-field" placeholder="请输入 ep-xxx 格式的 ID" />
                    </div>
                    <div class="ms-TextField">
                        <label class="ms-Label">润色模板</label>
                        <textarea id="prompt-polish-template" class="ms-TextField-field" rows="2">请对以下汉语学术文本进行补全和润色，要求术语准确、逻辑清晰、符合学术写作规范，保留原文核心含义：{text}</textarea>
                    </div>
                    <div class="ms-TextField">
                        <label class="ms-Label">翻译模板</label>
                        <textarea id="prompt-translate-template" class="ms-TextField-field" rows="2">请将以下润色后的汉语学术文本翻译成学术英语，要求语法正确、表达地道、符合英文论文写作规范：{text}</textarea>
                    </div>
                    <button id="btn-save-config" class="ms-Button ms-Button--primary">
                        <span class="ms-Button-label">保存并应用</span>
                    </button>
                    <div id="status-config" class="status-hint"></div>
                </div>
            </details>

            <!-- 功能卡片：汉语润色 -->
            <section class="action-card" id="section-polish">
                <div class="card-header">
                    <h2 class="ms-font-m">1. 汉语补全与润色</h2>
                    <div class="card-actions">
                        <button id="btn-polish-execute" class="action-btn primary" title="执行润色">
                            <i class="ms-Icon ms-Icon--Play" aria-hidden="true"></i>
                            执行
                        </button>
                    </div>
                </div>
                <div class="result-container">
                    <textarea id="result-polish" class="result-area" placeholder="选中 Word 文档中的内容后点击执行..."></textarea>
                    <div class="floating-actions">
                        <button id="btn-polish-apply" class="mini-btn" title="采纳到文档">
                            <i class="ms-Icon ms-Icon--CheckMark" aria-hidden="true"></i> 采纳
                        </button>
                    </div>
                </div>
                <div id="status-polish" class="status-hint"></div>
            </section>

            <!-- 功能卡片：学术译英 -->
            <section class="action-card" id="section-translate">
                <div class="card-header">
                    <h2 class="ms-font-m">2. 学术英语翻译</h2>
                    <div class="card-actions">
                        <button id="btn-translate-execute" class="action-btn primary" title="开始翻译">
                            <i class="ms-Icon ms-Icon--Translate" aria-hidden="true"></i>
                            执行
                        </button>
                    </div>
                </div>
                <div class="result-container">
                    <textarea id="result-translate" class="result-area" placeholder="翻译结果将基于上方的润色结果生成..."></textarea>
                    <div class="floating-actions">
                        <button id="btn-translate-apply" class="mini-btn" title="替换文中内容">
                            <i class="ms-Icon ms-Icon--CheckMark" aria-hidden="true"></i> 采纳
                        </button>
                    </div>
                </div>
                <div id="status-translate" class="status-hint"></div>
            </section>
        </main>

        <footer class="app-footer">
            <div id="global-status" class="status-hint"></div>
            <div class="app-info ms-font-xs">Word 学术写作助手 v1.2</div>
        </footer>
    </div>

    <!-- 加载遮罩 -->
    <div id="loading-overlay" class="overlay" style="display: none;">
        <div class="spinner"></div>
        <p class="ms-font-s">正在处理中...</p>
    </div>

    <script src="taskpane.js?v=1.2.0" type="module"></script>
</body>
</html>
